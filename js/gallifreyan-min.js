(function(e,h){Math.TWOPI=2*Math.PI;Math.HALFPI=Math.PI/2;Math.THREEQUARTERSPI=Math.PI+Math.HALFPI;e.draw_guidelines=false;e.guideline_color="#999933";e.Graphic=function(i){this.name="Graphic";this.canvas=typeof i!=="undefined"?i:null;this.line_color="#f0cc05";this.line_width=2;this.visible=true};e.Graphic.prototype._draw=function(i){i.strokeStyle=this.line_color;i.lineWidth=this.line_width;i.lineCap="round"};e.Graphic.prototype.draw=function(i){if(!this.visible){return}if(typeof i!=="undefined"){this.canvas=i}if((typeof this.canvas==="undefined")||(this.canvas===null)){return}context=this.canvas.getContext("2d");context.beginPath();this._draw(context);context.stroke()};e.Point=function(i,k,j){this.name="Point";this.x=typeof i!=="undefined"?i:0;this.y=typeof k!=="undefined"?k:0;if(typeof j==="number"){this.line_width=j}};e.Point.prototype=new gallifreyan.Graphic();e.Point.prototype._pre_draw=e.Point.prototype._draw;e.Point.prototype._draw=function(j){this._pre_draw(j);var i=this.line_width/2.01;j.arc(this.x,this.y,i,0,Math.TWOPI)};e.Point.prototype.moveXY=function(j,i){this.x+=j;this.y+=i;return this};e.Point.prototype.move=function(j,i){this.moveXY(Math.cos(j)*i,Math.sin(j)*i);return this};e.Point.prototype.isMouseOver=function(k,j){var i=Math.max(5,this.line_width);if((k<(this.x-i))||(k>(this.x+i))||(j<(this.y-i))||(j>(this.y+i))){return false}var n=k-this.x;var l=j-this.y;var m=Math.sqrt(n*n+l*l);return((m<=i)&&(m>=-i))};e.Line=function(j,i,l,k){this.name="Line";this.begin=new e.Point(j,i);this.end=new e.Point(l,k)};e.Line.prototype=new gallifreyan.Graphic();e.Line.prototype._pre_draw=e.Line.prototype._draw;e.Line.prototype._draw=function(i){this._pre_draw(i);i.moveTo(this.begin.x,this.begin.y);i.lineTo(this.end.x,this.end.y)};e.Line.prototype.boxContains=function(j){if(typeof j==="undefined"){return false}var k=0;var m=0;var i=0;var l=0;if(this.begin.x<this.end.x){k=this.begin.x;m=this.end.x}else{k=this.end.x;m=this.begin.x}if(this.begin.y<this.end.y){i=this.begin.y;l=this.end.y}else{i=this.end.y;l=this.begin.y}return((j.x>=k&&j.x<=m)&&(j.y>=i&&j.y<=l))};e.Line.prototype.intersectPoints=function(o){var m=[];if(typeof o==="undefined"||o==null){return m}if(typeof o.name==="undefined"||o.name==null){return m}if(o.name=="Circle"){var j=[];var l=b(this,o);for(var k in l){var n=l[k];if(this.boxContains(n)){j.push(n)}}return j}return m};e.Line.prototype.perpendicularMove=function(j){if(this.begin.x==this.end.x){this.begin.y+=j}else{if(this.begin.y==this.end.y){this.begin.x+=j}else{var i=Math.atan2(this.end.y-this.begin.y,this.end.x-this.begin.x);this.begin.move(i+Math.HALFPI,j);this.end.move(i+Math.HALFPI,j)}}return this};e.Line.prototype.isMouseOver=function(n,m){var l=Math.max(5,this.line_width/2);var s=Math.min(this.begin.x,this.end.x)-l;var p=Math.min(this.begin.y,this.end.y)-l;var i=Math.max(this.begin.x,this.end.x)+l;var v=Math.max(this.begin.y,this.end.y)+l;if((n<s)||(m<p)||(n>i)||(m>v)){return false}var w=this.end.x-this.begin.x;var u=this.end.y-this.begin.y;if(Math.abs(w)>0.001){var r=u/w;var o=this.begin.y-r*this.begin.x;var t=0;var q=0;var k=0;var j=0;if(r>0.001){t=Math.tan(Math.atan(r)+Math.HALFPI);q=m-(t*n);k=(q-o)/(r-t);j=r*k+o}else{t=r;q=n-(t*m);k=(t*o+q)/(1-r*t);j=r*k+o}return(c(n,m,k,j)<=l)}else{var r=w/u;var o=this.begin.x-r*this.begin.y;var t=0;var q=0;var k=0;var j=0;if(r>0.001){t=Math.tan(Math.atan(r)+Math.HALFPI);q=n-(t*m);j=(q-o)/(r-t);k=r*j+o}else{t=r;q=m-(t*n);j=(t*o+q)/(1-r*t);k=r*j+o}return(c(n,m,k,j)<=l)}return false};e.Circle=function(i,k,j){this.name="Circle";this.center=new e.Point(i,k);this.radius=typeof j!=="undefined"?j:1};e.Circle.prototype=new gallifreyan.Graphic();e.Circle.prototype._pre_draw=e.Circle.prototype._draw;e.Circle.prototype._draw=function(i){this._pre_draw(i);i.arc(this.center.x,this.center.y,this.radius,0,Math.TWOPI)};e.Circle.prototype.intersectPoints=function(j){var i=[];if(typeof j==="undefined"||j==null){return i}if(typeof j.name==="undefined"||j.name==null){return i}if(j.name=="Circle"){return d(this,j)}else{if(j.name=="Line"){return b(j,this)}}return i};e.Circle.prototype.isMouseOver=function(k,i){var n=k-this.center.x;var l=i-this.center.y;var m=Math.sqrt(n*n+l*l);var j=Math.max(5,this.line_width/2);return((m<=(this.radius+j))&&(m>=(this.radius-j)))};e.Arc=function(i,m,l,k,j){this.name="Arc";this.circle=new e.Circle(i,m,l);this.begin_angle=typeof k!=="undefined"?k:0;this.end_angle=typeof j!=="undefined"?j:Math.TWOPI};e.Arc.prototype=new gallifreyan.Graphic();e.Arc.prototype._pre_draw=e.Arc.prototype._draw;e.Arc.prototype._draw=function(i){this._pre_draw(i);i.arc(this.circle.center.x,this.circle.center.y,this.circle.radius,this.begin_angle,this.end_angle)};e.Arc.prototype.intersectPoints=function(m){var l=null;var j=null;var k=[];if(typeof m==="undefined"){return k}if(typeof m.name==="undefined"){return k}if(m.name=="Line"){isect_points=b(m,this.circle);result=[];for(l in isect_points){j=isect_points[l];if(this.containsPoint(j)&&m.boxContains(j)){result.push(j)}}return result}else{if(m.name=="Circle"){isect_points=d(this.circle,m);result=[];for(l in isect_points){j=isect_points[l];if(this.containsPoint(j)){result.push(j)}}return result}else{if(m.name=="Arc"){isect_points=d(this.circle,m.circle);result=[];for(l in isect_points){j=isect_points[l];if(this.containsPoint(j)&&m.containsPoint(j)){result.push(j)}}return result}}}return k};e.Arc.prototype.containsPoint=function(i){if(typeof i==="undefined"){return false}angle=Math.atan2(i.y-this.circle.center.y,i.x-this.circle.center.x);if((angle>=this.begin_angle)&&(angle<=this.end_angle)){return true}return false};e.Arc.prototype.isMouseOver=function(j,i){if(!this.circle.isMouseOver(j,i)){return false}var k=Math.atan2(i-this.circle.center.y,j-this.circle.center.x);var m=this.begin_angle;var n=this.end_angle;while(m>n){m-=Math.TWOPI}if((n>Math.PI)&&(k<(n-Math.TWOPI))){k+=Math.TWOPI}if((m<-Math.PI)&&(k>(m+Math.TWOPI))){k-=Math.TWOPI}var l=(k>=m)&&(k<=n);return l};e.Sentence=function(l,k,j,i){this.text=typeof l!=="undefined"?l:"";this.size=typeof i!=="undefined"?i:300;this.left=typeof k!=="undefined"?k:0;this.top=typeof j!=="undefined"?j:0;this.center_x=this.left+this.size/2;this.center_y=this.top+this.size/2;this.outside_circle=new e.Circle(this.center_x,this.center_y,this.size/2);this.outside_circle.line_width*=1.4;this.inside_circle=new e.Circle(this.center_x,this.center_y,this.size/2-6);this.words=[];this.setText(l)};e.Sentence.prototype.draw=function(j){var n=j.getContext("2d");n.clearRect(0,0,j.width,j.height);var m=n.createLinearGradient(0,0,j.width,j.height);m.addColorStop(0,"#00345c");m.addColorStop(1,"#00112b");n.fillStyle=m;n.fillRect(0,0,j.width,j.height);var l=null;var k=null;var o=null;this.outside_circle.draw(j);this.inside_circle.draw(j);for(l in this.words){this.words[l].draw(j)}};e.Sentence.prototype.setText=function(x){var m=null;var u=null;var r=null;this.words=[];this.text=this.preprocessText(x.trim());var j=this.inside_circle.radius*0.95;var l=this.text.split(" ");if(l&&l.length==1){r=new e.Word(l[0],this.center_x,this.center_y,j*2,this.inside_circle);this.words.push(r)}else{var n=-Math.TWOPI/l.length;var s=Math.PI/2;var t=Math.abs(Math.sin(n/2));var y=j*t/(1+t);var v=j-y;for(m in l){u=l[m];var k=Math.sin(s);var p=Math.cos(s);var q=this.center_x+v*p;var o=this.center_y+v*k;r=new e.Word(u,q,o,y*2,this.inside_circle);this.words.push(r);s+=n}}};e.Sentence.prototype.preprocessText=function(o){var l=/[a-z ]/i;var n=/[ei]/i;var j="";for(var k=0;k<o.length;++k){var p=o[k];if(!l.test(p)){continue}if(p=="c"){if(o.length>(k+1)){var m=o[k+1];if(n.test(m)){j+="s"}else{j+="k"}}else{j+="k"}}else{if(p=="q"){if(o.length>(k+1)){var m=o[k+1];if(m=="u"){j+="q"}else{j+="k"}}else{j+="k"}}else{j+=p}}}return j};e.Sentence.prototype.mouseOverObjects=function(m,k){var q=[];if(this.outside_circle.isMouseOver(m,k)){q.push(this.outside_circle)}if(this.inside_circle.isMouseOver(m,k)){q.push(this.inside_circle)}for(var p in this.words){var n=this.words[p].mouseOverObjects(m,k);for(var o in n){var l=n[o];q.push(l)}}return q};e.Sentence.prototype.setLineColor=function(k){this.inside_circle.line_color=k;this.outside_circle.line_color=k;for(var j in this.words){this.words[j].setLineColor(k)}};e.Word=function(m,k,j,l,i){this.max_diameter=typeof l!=="undefined"?l:250;this.radius=this.max_diameter/2;this.x=typeof k!=="undefined"?k:this.radius;this.y=typeof j!=="undefined"?j:this.radius;this.circle=new e.Circle(this.x,this.y,this.radius);this.circle.line_color=e.guideline_color;this.circle.line_width=1;this.sentence_circle=typeof i!=="undefined"?i:this.circle;this.arcs_circle=new e.Circle(this.x,this.y,this.radius);this.arcs_circle.line_color=e.guideline_color;this.arcs_circle.line_width=1;this.arcs=[new e.Arc(this.x,this.y,this.radius,0,Math.TWOPI)];this.text="";this.chars=[];this.setText(m)};e.Word.prototype.draw=function(j){var l=null;var k=null;for(l in this.arcs){k=this.arcs[l];k.draw(j)}for(l in this.chars){this.chars[l].draw(j)}if(e.draw_guidelines){this.circle.draw(j);this.arcs_circle.draw(j)}};e.Word.prototype.setText=function(j){this.text=j=j.trim().split(" ")[0];this.chars=[];var i=0;var k=null;while((j.length>0)&&(i!=j.length)){k=new e.Char(j);this.chars.push(k);i=j.length;j=j.substr(k.main.length*k.main_count+k.secondary.length*k.secondary_count)}this.setDimensions()};e.Word.prototype.setDimensions=function(){if(!this.chars||this.chars.length<=0){return}var i=20;if(this.chars.length>0){if(this.chars.length==1){this.arcs_circle.center.y=this.y-this.radius*0.15;this.arcs_circle.radius=this.radius*0.7;i=this.max_diameter}else{this.arcs_circle.center.y=this.y;var j=(Math.TWOPI/this.chars.length)/2;var l=Math.sin(j);i=2*this.arcs_circle.radius*Math.sin(j);var k=this.positionChars(i,true);this.arcs_circle.radius=k.radius;this.arcs_circle.center.x=k.center.x;this.arcs_circle.center.y=k.center.y;i=2*this.arcs_circle.radius*Math.sin(j);if(this.chars.length==2){i*=0.93}}this.positionChars(i)}};e.Word.prototype.positionChars=function(o,n){n=typeof n!=="boolean"?false:n;var F=null;var E=null;var y=Math.PI/2;var L=-Math.TWOPI/this.chars.length;var x=[];var I=true;var C=true;var t=null;var s=new e.Point(this.arcs_circle.center.x,this.arcs_circle.center.y);for(F in this.chars){var J=this.chars[F];J.sentence_circle=this.sentence_circle;J.up_angle=y+Math.PI;J.up_vector=new e.Point(Math.cos(J.up_angle),Math.sin(J.up_angle));J.word_circle=this.arcs_circle;J.x=this.arcs_circle.center.x+this.arcs_circle.radius*Math.cos(y);J.y=this.arcs_circle.center.y+this.arcs_circle.radius*Math.sin(y);J.setMaxDiameter(o);var z=J.word_intersect_points;if(z.length==2){var m=z[0];var l=z[1];var M=Math.atan2(m.y-this.arcs_circle.center.y,m.x-this.arcs_circle.center.x);var K=Math.atan2(l.y-this.arcs_circle.center.y,l.x-this.arcs_circle.center.x);var k=false;if((M>Math.HALFPI&&K<Math.HALFPI)||(K>Math.HALFPI&&M<Math.HALFPI)){k=true}M=f(M,-Math.THREEQUARTERSPI);K=f(K,-Math.THREEQUARTERSPI);if((K>M)||(I&&(M>-Math.PI)&&(K<-Math.PI))){var u=M;M=K;K=u}if(I){I=false;if(!k){t=M-Math.TWOPI;x.push(K)}else{t=K;x.push(M)}}else{x.push(M);x.push(K)}}if(n){s.x+=J.max_used_word_radius*Math.cos(J.up_angle)/this.chars.length;s.y+=J.max_used_word_radius*Math.sin(J.up_angle)/this.chars.length}y+=L}if(t){x.push(t)}if(x.length>0){this.arcs=[];for(F=0;F<x.length-1;F+=2){this.addArc(x[F+1],x[F])}}else{this.arcs=[new e.Arc(this.arcs_circle.center.x,this.arcs_circle.center.y,this.arcs_circle.radius,0,Math.TWOPI)]}var H=this.arcs_circle;if(n){var A=this.radius;for(F in this.chars){J=this.chars[F];var r=s.x-J.up_vector.x*this.max_diameter;var q=s.y-J.up_vector.y*this.max_diameter;var D=new e.Line(s.x,s.y,r,q);var z=D.intersectPoints(this.circle);if(z.length>0){var B=z[0];var w=B.x-s.x;var v=B.y-s.y;var G=Math.sqrt(w*w+v*v)*0.94;G-=J.max_used_word_radius-this.arcs_circle.radius;A=Math.min(A,G)}}H=new e.Circle(s.x,s.y,A)}return H};e.Word.prototype.shareCharModLines=function(){var l=0;var j=0;var k=null;for(l in this.chars){var m=this.chars[l];if(m.mod_lines&&m.mod_lines.length<=0){continue}if(k){m.shareModifierLine(k.mod_lines);k=null;continue}k=m}};e.Word.prototype.addArc=function(i,j){this.arcs.push(new e.Arc(this.arcs_circle.center.x,this.arcs_circle.center.y,this.arcs_circle.radius,i,j))};e.Word.prototype.mouseOverObjects=function(l,j){var q=[];for(var p in this.arcs){var o=this.arcs[p];if(o.isMouseOver(l,j)){q.push(o)}}for(var p in this.chars){var n=this.chars[p].mouseOverObjects(l,j);if(n.length>0){for(var m in n){q.push(n[m])}}}return q};e.Word.prototype.setLineColor=function(k){for(var j in this.arcs){this.arcs[j].line_color=k}for(var j in this.chars){this.chars[j].setLineColor(k)}};e.Char=function(n,k,j,m,l,o,i){this.draw_objects=[];this.max_circle=null;this.owner_intersect_object=null;this.x=typeof k!=="undefined"?k:this.radius;this.y=typeof j!=="undefined"?j:this.radius;this.up_angle=-Math.HALFPI;this.up_vector=typeof l!=="undefined"?l:new e.Point(0,-1);this.word_circle=typeof o!=="undefined"?o:new e.Circle(0,0,1);this.sentence_circle=typeof i!=="undefined"?i:this.word_circle;this.word_intersect_points=[];this.main="";this.main_count=0;this.secondary="";this.secondary_count=0;this.text="";this.getFirstChar(n);this.max_used_word_radius=this.word_circle.radius+this.radius;this.setMaxDiameter(m);this.dots=[];this.main_mod=null;this.secondary_mod=null;this.mod_lines=[];this.mod_line_secondary=null};e.Char.prototype.setX=function(i){this.x=typeof i!=="undefined"?i:this.radius;this.loadObjects()};e.Char.prototype.setY=function(i){this.y=typeof i!=="undefined"?i:this.radius;this.loadObjects()};e.Char.prototype.setMaxDiameter=function(i){this.max_diameter=typeof i!=="undefined"?i:50;this.radius=this.max_diameter/2;this.consonant_radius=this.radius*0.45;this.vowel_radius=this.consonant_radius*0.3;if(!this.max_circle){this.max_circle=new e.Circle()}this.max_circle.center.x=this.x;this.max_circle.center.y=this.y;this.max_circle.radius=this.max_diameter/2;this.max_circle.line_color=e.guideline_color;this.max_circle.line_width=1;this.loadObjects()};e.Char.prototype.draw=function(j){var k=null;for(k in this.draw_objects){this.draw_objects[k].draw(j)}if(e.draw_guidelines&&this.max_circle){this.max_circle.draw(j)}};e.Char.prototype.loadObjects=function(){this.draw_objects=[];if(!this.main||this.main.length<=0||this.main_count<=0){return}if(/^([bdfgh]|ch)$/i.test(this.main)){var i=null;if(this.main=="ch"){i="2dots"}else{if(this.main=="d"){i="3dots"}else{if(this.main=="f"){i="3lines"}else{if(this.main=="g"){i="1line"}else{if(this.main=="h"){i="2lines"}}}}}this.loadB(i)}else{if(/^[jklmnp]$/i.test(this.main)){var i=null;if(this.main=="k"){i="2dots"}else{if(this.main=="l"){i="3dots"}else{if(this.main=="m"){i="3lines"}else{if(this.main=="n"){i="1line"}else{if(this.main=="p"){i="2lines"}}}}}this.loadJ(i)}else{if(/^([trsvw]|sh)$/i.test(this.main)){var i=null;if(this.main=="sh"){i="2dots"}else{if(this.main=="r"){i="3dots"}else{if(this.main=="s"){i="3lines"}else{if(this.main=="v"){i="1line"}else{if(this.main=="w"){i="2lines"}}}}}this.loadT(i)}else{if(/^([yzx]|th|ng|qu)$/i.test(this.main)){var i=null;if(this.main=="y"){i="2dots"}else{if(this.main=="z"){i="3dots"}else{if(this.main=="ng"){i="3lines"}else{if(this.main=="qu"){i="1line"}else{if(this.main=="x"){i="2lines"}}}}}this.loadTH(i)}else{if(/^a$/i.test(this.main)){this.loadA(this.word_circle)}else{if(/^e$/i.test(this.main)){this.loadE(this.word_circle)}else{if(/^i$/i.test(this.main)){this.loadI(this.word_circle)}else{if(/^o$/i.test(this.main)){this.loadO(this.word_circle)}else{if(/^u$/i.test(this.main)){this.loadU(this.word_circle)}else{this.loadOther()}}}}}}}}}};e.Char.prototype.loadModifier=function(m,k,p,l){var j=1;var w=this.consonant_radius*0.07;var o=this.consonant_radius*0.1;var q=k.radius/Math.PI;this.dots=[];this.mod_lines=[];switch(m){case"3dots":var i=(this.up_angle*q-o)/q;var s=new e.Point(k.center.x+Math.cos(i)*(k.radius-o*1.8),k.center.y+Math.sin(i)*(k.radius-o*1.8),w);this.dots.push(s);this.draw_objects.push(s);var v=new e.Point(k.center.x+this.up_vector.x*(k.radius-o*1.8),k.center.y+this.up_vector.y*(k.radius-o*1.8),o);this.dots.push(v);this.draw_objects.push(v);var n=(this.up_angle*q+o)/q;var t=new e.Point(k.center.x+Math.cos(n)*(k.radius-o*1.8),k.center.y+Math.sin(n)*(k.radius-o*1.8),w);this.dots.push(t);this.draw_objects.push(t);break;case"2dots":var u=(this.up_angle*q-w/1.8)/q;var v=new e.Point(k.center.x+Math.cos(u)*(k.radius-o*1.5),k.center.y+Math.sin(u)*(k.radius-o*1.5),w);this.draw_objects.push(v);var n=(this.up_angle*q+w/1.8)/q;var t=new e.Point(k.center.x+Math.cos(n)*(k.radius-o*1.5),k.center.y+Math.sin(n)*(k.radius-o*1.5),w);this.draw_objects.push(t);break;case"2lines":var r=a(2,p,l);this.loadModifierLine(k,r[0]);this.loadModifierLine(k,r[1]);break;case"3lines":var r=a(3,p,l);this.loadModifierLine(k,r[0]);this.loadModifierLine(k,r[1]);this.loadModifierLine(k,r[2]);break;case"1line":var r=a(1,p,l);this.loadModifierLine(k,r[0]);break}};e.Char.prototype.loadModifierLine=function(m,n,j){if(typeof(j)==="undefined"){j=false}var i=new e.Line(m.center.x+Math.cos(n)*(m.radius+m.line_width/2),m.center.y+Math.sin(n)*(m.radius+m.line_width/2),m.center.x+Math.cos(n)*this.sentence_circle.radius*2,m.center.y+Math.sin(n)*this.sentence_circle.radius*2);var k=i.intersectPoints(this.sentence_circle);if(k.length>0){i.end=k[0]}i.holder_circle=m;if(j){this.mod_line_secondary=i}else{this.mod_lines.push(i)}this.draw_objects.push(i)};e.Char.prototype.shareModifierLine=function(t){if(this.mod_lines&&this.mod_lines.length<=0){return}var n=0;var p=0;var o=this.mod_lines.length-1;for(p in t){var k=t[p];if(!k||(o<0)){continue}this_line=this.mod_lines[o];var l=new e.Line(this_line.holder_circle.center.x,this_line.holder_circle.center.y,k.holder_circle.center.x,k.holder_circle.center.y);var s=Math.min(this_line.holder_circle.radius,k.holder_circle.radius)*0.7;var m=(o/(this.mod_lines.length-1))*s-(s/2);l.perpendicularMove(m);var r=l.intersectPoints(this_line.holder_circle);if(r.length<=0){return}var q=l.intersectPoints(k.holder_circle);if(q.length<=0){return}this_line.begin.x=r[0].x;this_line.begin.y=r[0].y;this_line.end.x=q[0].x;this_line.end.y=q[0].y;k.visible=false;--o}};e.Char.prototype.loadArc=function(l,j,k){var p=0;var n=Math.TWOPI;var o=k?false:true;var i=j.intersectPoints(this.word_circle);if(i.length==2){var m=Math.atan2(i[0].y-j.center.y,i[0].x-j.center.x);var s=Math.atan2(i[1].y-j.center.y,i[1].x-j.center.x);p=m;n=s;if(o){this.word_intersect_points=[i[0],i[1]]}}else{if(o){this.word_intersect_points=[]}}var r=new e.Arc();r.circle=j;r.begin_angle=p;r.end_angle=n;this.draw_objects.push(r);while(n<p){n+=Math.TWOPI}var q=Math.min(Math.PI/4,(n-p)/2.5);this.loadModifier(l,j,this.up_angle-q,this.up_angle+q)};e.Char.prototype.loadB=function(j){var n=this.consonant_radius*0.9;var o=new e.Circle(this.x+n*this.up_vector.x,this.y+n*this.up_vector.y,this.consonant_radius);this.owner_intersect_object=o;this.loadArc(j,o);this.max_used_word_radius=this.word_circle.radius;if(this.main_count>1){var m=o.radius;for(var l=1;l<this.main_count;++l){m+=o.line_width*2;var k=new e.Circle(o.center.x,o.center.y,m);this.loadArc(null,k,true)}}this.loadSecondaryVowel(o,true)};e.Char.prototype.loadJ=function(j){var o=this.radius*0.55;var p=new e.Circle(this.x+o*this.up_vector.x,this.y+o*this.up_vector.y,this.consonant_radius);this.owner_intersect_object=p;this.draw_objects.push(p);var n=Math.PI/4;this.loadModifier(j,p,this.up_angle-n,this.up_angle+n);this.max_used_word_radius=this.word_circle.radius;if(this.main_count>1){var m=p.radius;for(var l=1;l<this.main_count;++l){m+=p.line_width*2;var k=new e.Circle(p.center.x,p.center.y,m);this.draw_objects.push(k)}}this.loadSecondaryVowel(p)};e.Char.prototype.loadT=function(j){var n=-this.consonant_radius*2.3;var o=new e.Circle(this.x+n*this.up_vector.x,this.y+n*this.up_vector.y,this.consonant_radius*3.2);this.loadArc(j,o);this.max_used_word_radius=this.word_circle.radius;if(this.main_count>1){var m=o.radius;for(var l=1;l<this.main_count;++l){m+=o.line_width*2;var k=new e.Circle(o.center.x,o.center.y,m);this.loadArc(null,k,true)}}this.loadSecondaryVowel(o)};e.Char.prototype.loadTH=function(i){var k=new e.Circle(this.x,this.y,this.consonant_radius);this.draw_objects.push(k);var j=Math.PI/3;this.loadModifier(i,k,this.up_angle-j,this.up_angle+j);this.max_used_word_radius=this.word_circle.radius+this.consonant_radius;this.loadSecondaryVowel(k)};e.Char.prototype.repeatVowel=function(k,j){function i(q,n,p){if(n>1){var o=q.radius;for(var m=1;m<n;++m){o-=q.line_width*2;if(o>0){var l=new e.Circle(q.center.x,q.center.y,o);p.push(l)}}}}if(j){i(k,this.secondary_count,this.draw_objects)}else{i(k,this.main_count,this.draw_objects)}};e.Char.prototype.loadA=function(k,j){j=typeof j==="boolean"?j:false;var i=1.6;var l=new e.Circle(this.x-this.up_vector.x*this.vowel_radius*i,this.y-this.up_vector.y*this.vowel_radius*i,this.vowel_radius);if(!(j&&/^([yzx]|th|ng|qu)$/i.test(this.main))){this.max_used_word_radius=this.word_circle.radius+this.vowel_radius*i}this.draw_objects.push(l);this.repeatVowel(l,j);return l};e.Char.prototype.loadE=function(l,k){k=typeof k==="boolean"?k:false;var j=this.x;var i=this.y;if(k){if(/^([trsvw]|sh)$/i.test(this.main)){j=this.x+this.up_vector.x*this.vowel_radius;i=this.y+this.up_vector.y*this.vowel_radius}else{j=l.center.x;i=l.center.y}}var m=new e.Circle(j,i,this.vowel_radius);if(!k){this.max_used_word_radius=this.word_circle.radius+this.vowel_radius}this.draw_objects.push(m);this.repeatVowel(m,k);return m};e.Char.prototype.loadI=function(k,i){i=typeof i==="boolean"?i:false;var m=this.loadE(k,i);this.dots=[];this.mod_lines=[];var j=Math.PI/12;var l=a(1,this.up_angle-j,this.up_angle+j);this.loadModifierLine(m,l[0],true)};e.Char.prototype.loadO=function(m,l){l=typeof l==="boolean"?l:false;var j=1.5;var k=0;var i=0;if(l){k=m.center.x+this.up_vector.x*m.radius;i=m.center.y+this.up_vector.y*m.radius}else{k=this.x+this.up_vector.x*this.vowel_radius*j;i=this.y+this.up_vector.y*this.vowel_radius*j}var n=new e.Circle(k,i,this.vowel_radius);if(!(l&&/^([yzx]|th|ng|qu)$/i.test(this.main))){this.max_used_word_radius=this.word_circle.radius}this.draw_objects.push(n);this.repeatVowel(n,l);return n};e.Char.prototype.loadU=function(k,i){var m=this.loadE(k,i);this.dots=[];this.mod_lines=[];var j=Math.PI/12;var l=a(1,this.up_angle+Math.PI-j,this.up_angle+Math.PI+j);this.loadModifierLine(m,l[0],true)};e.Char.prototype.loadSecondaryVowel=function(i){if(/^a$/i.test(this.secondary)){this.loadA(this.word_circle,true)}else{if(/^e$/i.test(this.secondary)){this.loadE(i,true)}else{if(/^i$/i.test(this.secondary)){this.loadI(i,true)}else{if(/^o$/i.test(this.secondary)){this.loadO(i,true)}else{if(/^u$/i.test(this.secondary)){this.loadU(i,true)}}}}}};e.Char.prototype.loadOther=function(){var i=new e.Point(this.x,this.y);i.line_color="#ff0000";i.line_width=8;this.draw_objects.push(i)};e.Char.prototype.getFirstChar=function(l){this.main="";this.main_count=0;this.secondary="";this.secondary_count=0;if(l==null||l.length<=0){return}var o=/^[aeiou]/i;var i=/^[bcdfghjklmnprstvwxyz]/i;var n=/^(th|ch|sh|ng|qu)/i;var m=l[0];if(o.test(m)){this.main=m;this.main_count=this.countCharRepeat(l)}else{var k=l.substr(0,2);if(n.test(k)){this.main=k;this.main_count=1}else{this.main=m;this.main_count=this.countCharRepeat(l)}var j=this.main.length*this.main_count;if(l.length>j){m=l[j];if(o.test(m)){this.secondary=m;this.secondary_count=this.countCharRepeat(l,j)}}}};e.Char.prototype.countCharRepeat=function(m,j){j=typeof j!=="undefined"?j:0;var k=0;var l=0;var n=null;if(j>=m.length){return 0}for(k=j;k<m.length;k++){if(k==j){n=m[k];l=1}else{if(n==m[k]){l+=1}else{break}}}return l};e.Char.prototype.mouseOverObjects=function(k,j){var m=[];for(var l in this.draw_objects){var n=this.draw_objects[l];if(n.isMouseOver(k,j)){m.push(n)}}for(var l in this.mod_lines){var n=this.mod_lines[l];if(n.isMouseOver(k,j)){m.push(n)}}if(this.mod_line_secondary){if(this.mod_line_secondary.isMouseOver(k,j)){m.push(this.mod_line_secondary)}}return m};e.Char.prototype.setLineColor=function(k){for(var j in this.draw_objects){this.draw_objects[j].line_color=k}for(var j in this.mod_lines){this.mod_lines[j].line_color=k}if(this.mod_line_secondary){this.mod_line_secondary.line_color=k}};function b(w,j){default_result=[];var q=new e.Point();var o=new e.Point();var m=0;var k=0;var i=0;var n=j.center.y*j.center.y;var u=j.center.x*j.center.x;var l=j.radius*j.radius;if(Math.abs(w.begin.x-w.end.x)<0.000001){var s=w.begin.x;m=1;k=-2*j.center.y;i=s*s-2*s*j.center.x+u+n-l;var t=g(m,k,i);if(t.length!=2){return default_result}q.x=s;q.y=t[0];o.x=s;o.y=t[1]}else{var r=(w.end.y-w.begin.y)/(w.end.x-w.begin.x);var p=w.begin.y-(r*w.begin.x);m=r*r+1;k=2*(r*p-r*j.center.y-j.center.x);i=(u+n-l-(2*p*j.center.y)+p*p);var v=g(m,k,i);if(v.length!=2){return default_result}q.x=v[0];q.y=r*q.x+p;o.x=v[1];o.y=r*o.x+p}return[q,o]}function d(l,k){default_result=[];if(!l||!k){return default_result}var r=l.center.x-k.center.x;var p=l.center.y-k.center.y;var t=Math.sqrt(r*r+p*p);if((t<0.000001)||(t>(l.radius+k.radius))||(t<Math.abs(l.radius-k.radius))){return default_result}var x=l.radius*l.radius;var o=k.radius*k.radius;var v=(x-o+t*t)/(t+t);var m=Math.sqrt(x-v*v);var w=new e.Point();var q=new e.Point();var n=new e.Point();var u=v/t;var j=k.center.x-l.center.x;var s=k.center.y-l.center.y;w.x=l.center.x+(u*j);w.y=l.center.y+(u*s);var i=m/t;q.x=w.x+(i*s);n.x=w.x-(i*s);q.y=w.y-(i*j);n.y=w.y+(i*j);return[q,n]}function g(i,l,j){if(i!=0){var k=l*l-4*i*j;if(k<0){return[]}sqrt_delta=Math.sqrt(k);r1=(-l+sqrt_delta)/(2*i);r2=(-l-sqrt_delta)/(2*i);return[r1,r2]}else{if(l!=0){return[-j/l]}}return[]}function f(j,i){while(j<i){j+=Math.TWOPI}end_angle=i+Math.TWOPI;while(j>end_angle){j-=Math.TWOPI}return j}function c(l,n,k,m){var j=k-l;var i=m-n;return Math.sqrt(j*j+i*i)}function a(q,n,k){var s=[];if(typeof(q)==="undefined"||q<=0){return s}var n=typeof(n)==="undefined"?0:n;var k=typeof(k)==="undefined"?Math.TWOPI:k;if(n>k){n-=Math.TWOPI}var o=k-n;var m=0;var l=q*3;var r=[];var j=o/(l-1);for(m=n;m<=k;m+=j){r.push(m)}for(m=0;m<q;++m){var p=Math.floor(Math.random()*r.length);s.push(r[p]);r.splice(p,1)}return s}e.drawTest=function(i){var j=new e.Sentence("bthtj",20,20,460);j.draw(i)}}(window.gallifreyan=window.gallifreyan||{}));