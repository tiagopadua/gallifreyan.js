<!DOCTYPE html>
<html>

<head>
 <title>Gallifreyan Translator</title>
 <link href="../css/bootstrap.min.css" rel="stylesheet" type="text/css">
 <link href="../css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css">
 <link href="../css/dr_who.css" rel="stylesheet" type="text/css">
</head>

<body>
 <div class="container" id="mainContainer">
  <input type="text" placeholder="Type your text to translate" onchange="textChanged(this);" onkeypress="this.onchange();" onpaste="this.onchange();" oninput="this.onchange();" style="margin-bottom:0px;"/>
  <a id="download" download="gallifreyan.png"><input type="button" value="Download as PNG"/></a>
  <span id="coords">0x0</span>
  <br/>
  <input type="checkbox" id="guidelines">Draw guidelines</input>
  <div class="blueprint">
   <canvas id="canvas" width="500" height="500" class="img-rounded"></canvas>
  </div>
 </div>
 <script type="text/javascript" src="../js/gallifreyan.js"></script>
 <script language="javascript">

var draw_target = document.getElementById("canvas");
var sentence = new gallifreyan.Sentence('', 20, 20, 460);
sentence.draw(document.getElementById("canvas"));

function textChanged(obj) {
    sentence.setText(obj.value);
    sentence.draw(draw_target);
}

document.getElementById('canvas').onmousemove = function(e) {
    document.getElementById('coords').innerText = e.offsetX.toString() + "x" + e.offsetY.toString();
    var over_objects = sentence.mouseOverObjects(e.offsetX, e.offsetY);
    sentence.setLineColor("#ffffff");
    if (over_objects.length > 0) {
       console.log("MOUSE OVER");
       for (var i in over_objects) {
          over_objects[i].line_color = "#ff3311";
       }
    }
    sentence.draw(draw_target);
};

document.getElementById('download').onclick = function() {
    var canvas = document.getElementById("canvas");
    this.href = canvas.toDataURL("image/png");
};

document.getElementById("guidelines").onchange = function(e){
  if(e) {
    gallifreyan.draw_guidelines = e.target.checked;
    sentence.draw(draw_target)
  }
};

 </script>
</body>

</html>